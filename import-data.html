<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importation de données - PERENCO Cameroun</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="navbar-container">
                <div class="logo">
                    <a href="index.html">
                        <svg role="img" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="180" height="55" viewBox="0 0 192 58.294" class="logo-svg">
                            <g fill="#ffffff">
                                <path d="M192.001 48.539h-11.364l-4.464 9.755-4.672-9.748H160.53a.185.185 0 0 1-.036-.231c.5-.79.9-1.638 1.333-2.464.28-.532.588-1.052.858-1.59.063-.126.186-.235.074-.405-.052-.08.039-.193.09-.22.406-.22.528-.648.723-1.006.749-1.38 1.461-2.78 2.2-4.166.748-1.406 1.517-2.8 2.266-4.207s1.476-2.8 2.214-4.194c.247-.469.5-.937.748-1.4a1.121 1.121 0 0 0 .161-.486 817.913 817.913 0 0 0 2.6-4.861 10.222 10.222 0 0 0 1.291-2.433 8.944 8.944 0 0 0 1.035-1.79 10.241 10.241 0 0 1 .577 1.008c.437.733.829 1.493 1.24 2.239.225.408.463.826.669 1.253.247.511.557 1 .818 1.5.246.474.512.941.759 1.415s.536.927.775 1.394c.694 1.354 1.427 2.687 2.149 4.025q4.371 8.094 8.76 16.178c.053.1.114.192.171.289Z"></path>
                                <path d="M0 25.127h5.37c.039 0 .077-.058.12-.093.292.29.688.223 1.042.276a4.243 4.243 0 0 1 3.226 1.875 3.491 3.491 0 0 1 .448 2.616c-.432 2.042-1.472 2.917-3.591 3.245a14.882 14.882 0 0 1-2.265.138H3v5.288H0Zm2.96 5.581a11.749 11.749 0 0 0 3.047-.19 1.42 1.42 0 0 0 1.1-1.228 1.4 1.4 0 0 0-1.234-1.512 13.392 13.392 0 0 0-2.7-.158c-.073 0-.152-.011-.206.068Z"></path>
                                <path d="M96.997 27.698h2.531v10.755h-2.881l-4.883-7.026a.567.567 0 0 0-.182.52V38.448h-2.511v-10.76h2.792c.174 0 .339.016.4.2a6.59 6.59 0 0 0 .592.936c.065.126.206.121.292.2.043.467.4.76.643 1.11 1.011 1.481 2.055 2.94 3.088 4.406.021.029.048.053.119.13Z"></path>
                            </g>
                        </svg>
                    </a>
                </div>
                <div class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="index.html" class="nav-link">Accueil</a></li>
                    <li class="nav-item"><a href="plateformes.html" class="nav-link">Plateformes</a></li>
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">Tableau de bord</a></li>
                    <li class="nav-item"><a href="pid-management.html" class="nav-link active">Gestion PIDs</a></li>
                    <li class="nav-item"><a href="about.html" class="nav-link">À propos</a></li>
                    <li class="nav-item"><a href="login.html" class="nav-link login-btn">Connexion</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <div class="page-header-content">
                <h1>Importation de données</h1>
                <p>Mettez à jour les informations des PIDs en important des fichiers Excel</p>
            </div>
        </section>

        <section class="import-section auth-required">
            <div class="container">
                <div class="import-container">
                    <div class="import-card">
                        <div class="import-header">
                            <h2><i class="fas fa-file-excel"></i> Importer des données</h2>
                            <p>Sélectionnez un fichier Excel contenant les données des PIDs à mettre à jour</p>
                        </div>
                        
                        <div class="import-body">
                            <div class="file-upload-container">
                                <div class="file-upload-area" id="drop-area">
                                    <input type="file" id="fileInput" accept=".xlsx, .xls" hidden>
                                    <div class="file-upload-content">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>Glissez et déposez votre fichier Excel ici</p>
                                        <p>ou</p>
                                        <button class="btn btn-primary" id="browseBtn">Parcourir les fichiers</button>
                                        <p class="file-types">Formats acceptés: .xlsx, .xls</p>
                                    </div>
                                </div>
                                <div class="selected-file" id="selected-file" style="display: none;">
                                    <div class="file-info">
                                        <i class="fas fa-file-excel"></i>
                                        <div class="file-details">
                                            <p class="file-name" id="file-name">filename.xlsx</p>
                                            <p class="file-size" id="file-size">0 KB</p>
                                        </div>
                                    </div>
                                    <button class="btn-icon" id="remove-file">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="import-options">
                                <h3>Options d'importation</h3>
                                <div class="option-group">
                                    <label>
                                        <input type="checkbox" id="overwrite" checked>
                                        Écraser les données existantes
                                    </label>
                                </div>
                                <div class="option-group">
                                    <label>
                                        <input type="checkbox" id="validate" checked>
                                        Valider les données avant l'importation
                                    </label>
                                </div>
                                <div class="option-group">
                                    <label for="sheet-select">Feuille Excel à importer:</label>
                                    <select id="sheet-select" disabled>
                                        <option value="">Sélectionnez un fichier d'abord</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="import-preview" id="import-preview" style="display: none;">
                                <h3>Aperçu des données</h3>
                                <div class="preview-table-container">
                                    <table class="preview-table" id="preview-table">
                                        <thead>
                                            <tr>
                                                <th>Plateforme</th>
                                                <th>Nom PID</th>
                                                <th>Numéro d'identification</th>
                                                <th>Statut</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Preview data will be inserted here -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="preview-pagination">
                                    <span>Affichage de <span id="showing-start">1</span>-<span id="showing-end">10</span> sur <span id="total-rows">0</span> lignes</span>
                                    <div class="pagination-controls">
                                        <button id="prev-page" disabled><i class="fas fa-chevron-left"></i></button>
                                        <span id="current-page">1</span>
                                        <button id="next-page"><i class="fas fa-chevron-right"></i></button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="import-actions">
                                <button class="btn btn-secondary" id="cancel-btn">Annuler</button>
                                <button class="btn btn-primary" id="import-btn" disabled>Importer les données</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="import-history-card">
                        <div class="import-history-header">
                            <h2>Historique des importations</h2>
                        </div>
                        <div class="import-history-body">
                            <div class="history-item">
                                <div class="history-icon success">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="history-content">
                                    <div class="history-title">
                                        <h3>Mise à jour des PIDs - Plateforme VT</h3>
                                        <span class="history-date">Aujourd'hui, 14:25</span>
                                    </div>
                                    <p>34 PIDs mis à jour avec succès</p>
                                </div>
                            </div>
                            <div class="history-item">
                                <div class="history-icon warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="history-content">
                                    <div class="history-title">
                                        <h3>Mise à jour des PIDs - Plateforme BAP</h3>
                                        <span class="history-date">Hier, 10:12</span>
                                    </div>
                                    <p>28 PIDs mis à jour, 2 erreurs détectées</p>
                                </div>
                            </div>
                            <div class="history-item">
                                <div class="history-icon success">
                                    <i class="fas fa-check"></i>
                                </div>
                                <div class="history-content">
                                    <div class="history-title">
                                        <h3>Mise à jour des PIDs - Plateforme ESP1</h3>
                                        <span class="history-date">12/05/2025, 09:45</span>
                                    </div>
                                    <p>23 PIDs mis à jour avec succès</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="non-auth-content">
            <div class="container">
                <div class="auth-required-message">
                    <div class="message-content">
                        <i class="fas fa-lock"></i>
                        <h2>Accès restreint</h2>
                        <p>Vous devez être connecté pour accéder à cette fonctionnalité.</p>
                        <div class="message-buttons">
                            <a href="login.html" class="btn btn-primary">Se connecter</a>
                            <a href="register.html" class="btn btn-secondary">Créer un compte</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <svg role="img" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="150" height="45" viewBox="0 0 192 58.294" class="logo-svg">
                    <g fill="#ffffff">
                        <path d="M192.001 48.539h-11.364l-4.464 9.755-4.672-9.748H160.53a.185.185 0 0 1-.036-.231c.5-.79.9-1.638 1.333-2.464.28-.532.588-1.052.858-1.59.063-.126.186-.235.074-.405-.052-.08.039-.193.09-.22.406-.22.528-.648.723-1.006.749-1.38 1.461-2.78 2.2-4.166.748-1.406 1.517-2.8 2.266-4.207s1.476-2.8 2.214-4.194c.247-.469.5-.937.748-1.4a1.121 1.121 0 0 0 .161-.486 817.913 817.913 0 0 0 2.6-4.861 10.222 10.222 0 0 0 1.291-2.433 8.944 8.944 0 0 0 1.035-1.79 10.241 10.241 0 0 1 .577 1.008c.437.733.829 1.493 1.24 2.239.225.408.463.826.669 1.253.247.511.557 1 .818 1.5.246.474.512.941.759 1.415s.536.927.775 1.394c.694 1.354 1.427 2.687 2.149 4.025q4.371 8.094 8.76 16.178c.053.1.114.192.171.289Z"></path>
                    </g>
                </svg>
                <p>PERENCO Cameroun</p>
            </div>
            <div class="footer-links">
                <div class="footer-section">
                    <h3>Navigation</h3>
                    <ul>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="plateformes.html">Plateformes</a></li>
                        <li><a href="dashboard.html">Tableau de bord</a></li>
                        <li><a href="about.html">À propos</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Douala, Cameroun</li>
                        <li><i class="fas fa-phone"></i> +237 233 XX XX XX</li>
                        <li><i class="fas fa-envelope"></i> contact@perenco-cameroun.com</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 PERENCO Cameroun. Tous droits réservés.</p>
        </div>
    </footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="js/init.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/pid-management.js"></script>
</body>
</html>