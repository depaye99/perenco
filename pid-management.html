<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des PIDs - PERENCO Cameroun</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/user-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="navbar-container">
                <div class="logo">
                    <a href="index.html">
                        <svg role="img" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="180" height="55" viewBox="0 0 192 58.294" class="logo-svg">
                            <g fill="#ffffff">
                                <path d="M192.001 48.539h-11.364l-4.464 9.755-4.672-9.748H160.53a.185.185 0 0 1-.036-.231c.5-.79.9-1.638 1.333-2.464.28-.532.588-1.052.858-1.59.063-.126.186-.235.074-.405-.052-.08.039-.193.09-.22.406-.22.528-.648.723-1.006.749-1.38 1.461-2.78 2.2-4.166.748-1.406 1.517-2.8 2.266-4.207s1.476-2.8 2.214-4.194c.247-.469.5-.937.748-1.4a1.121 1.121 0 0 0 .161-.486 817.913 817.913 0 0 0 2.6-4.861 10.222 10.222 0 0 0 1.291-2.433 8.944 8.944 0 0 0 1.035-1.79 10.241 10.241 0 0 1 .577 1.008c.437.733.829 1.493 1.24 2.239.225.408.463.826.669 1.253.247.511.557 1 .818 1.5.246.474.512.941.759 1.415s.536.927.775 1.394c.694 1.354 1.427 2.687 2.149 4.025q4.371 8.094 8.76 16.178c.053.1.114.192.171.289Z"></path>
                                <path d="M0 25.127h5.37c.039 0 .077-.058.12-.093.292.29.688.223 1.042.276a4.243 4.243 0 0 1 3.226 1.875 3.491 3.491 0 0 1 .448 2.616c-.432 2.042-1.472 2.917-3.591 3.245a14.882 14.882 0 0 1-2.265.138H3v5.288H0Zm2.96 5.581a11.749 11.749 0 0 0 3.047-.19 1.42 1.42 0 0 0 1.1-1.228 1.4 1.4 0 0 0-1.234-1.512 13.392 13.392 0 0 0-2.7-.158c-.073 0-.152-.011-.206.068Z"></path>
                                <path d="M96.997 27.698h2.531v10.755h-2.881l-4.883-7.026a.567.567 0 0 0-.182.52V38.448h-2.511v-10.76h2.792c.174 0 .339.016.4.2a6.59 6.59 0 0 0 .592.936c.065.126.206.121.292.2.043.467.4.76.643 1.11 1.011 1.481 2.055 2.94 3.088 4.406.021.029.048.053.119.13Z"></path>
                            </g>
                        </svg>
                    </a>
                </div>
                <div class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="index.html" class="nav-link">Accueil</a></li>
                    <li class="nav-item"><a href="plateformes.html" class="nav-link">Plateformes</a></li>
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">Tableau de bord</a></li>
                    <li class="nav-item"><a href="pid-management.html" class="nav-link active">Gestion PIDs</a></li>
                    <li class="nav-item"><a href="about.html" class="nav-link">À propos</a></li>
                    <li class="nav-item"><a href="login.html" class="nav-link login-btn">Connexion</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <div class="page-header-content">
                <h1>Gestion des PIDs</h1>
                <p>Consultez, modifiez et gérez les PIDs par zone et plateforme</p>
            </div>
        </section>

        <!-- Message pour les utilisateurs non authentifiés -->
        <section class="non-auth-content">
            <div class="container">
                <div class="auth-required-message">
                    <div class="message-content">
                        <i class="fas fa-lock"></i>
                        <h2>Accès restreint</h2>
                        <p>Veuillez vous connecter pour accéder à la gestion des PIDs.</p>
                        <div class="message-buttons">
                            <a href="login.html" class="btn btn-primary">Se connecter</a>
                            <a href="register.html" class="btn btn-secondary">Créer un compte</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contenu réservé aux utilisateurs authentifiés -->
        <section class="pid-management-section auth-required">
            <div class="container">
                <!-- Navigation hiérarchique -->
                <div class="hierarchy-navigation">
                    <div class="breadcrumb">
                        <span id="current-level">Filiale</span>
                        <span id="breadcrumb-path"></span>
                    </div>
                    <div class="hierarchy-actions">
                        <button id="back-button" class="btn btn-outline" disabled>
                            <i class="fas fa-arrow-left"></i> Retour
                        </button>
                        <button id="add-item-button" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Ajouter
                        </button>
                        <button id="import-button" class="btn btn-secondary">
                            <i class="fas fa-file-import"></i> Importer
                        </button>
                        <button id="export-button" class="btn btn-secondary">
                            <i class="fas fa-file-export"></i> Exporter
                        </button>
                    </div>
                </div>

                <!-- Barre de recherche et filtres -->
                <div class="search-filter-container">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="Rechercher par nom, numéro...">
                        <button id="search-button"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="filters">
                        <select id="filter-zone" class="filter-select">
                            <option value="">Toutes les zones</option>
                        </select>
                        <select id="filter-status" class="filter-select">
                            <option value="">Tous les statuts</option>
                            <option value="verified">Vérifié</option>
                            <option value="pending">En attente</option>
                        </select>
                        <select id="filter-field" class="filter-select">
                            <option value="">Tous les champs</option>
                        </select>
                        <button id="reset-filters" class="btn btn-outline">Réinitialiser</button>
                    </div>
                </div>

                <!-- Affichage hiérarchique -->
                <div class="hierarchy-display">
                    <!-- Affichage des éléments (champs, zones, plateformes, PIDs) -->
                    <div id="hierarchy-items" class="hierarchy-items">
                        <!-- Les éléments seront chargés dynamiquement ici -->
                    </div>
                </div>

                <!-- Tableau des PIDs (visible uniquement au niveau PID) -->
                <div id="pid-table-container" class="pid-table-container" style="display: none;">
                    <table class="pid-table">
                        <thead>
                            <tr>
                                <th>Nom du PID</th>
                                <th>Numéro</th>
                                <th>Plateforme</th>
                                <th>Zone</th>
                                <th>Champ</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="pid-table-body">
                            <!-- Les PIDs seront chargés dynamiquement ici -->
                        </tbody>
                    </table>

                    <!-- Pagination -->
                    <div class="pagination">
                        <div class="pagination-info">
                            Affichage de <span id="showing-start">1</span> à <span id="showing-end">10</span> sur <span id="total-items">0</span> éléments
                        </div>
                        <div class="pagination-controls">
                            <button id="prev-page" disabled><i class="fas fa-chevron-left"></i></button>
                            <div id="pagination-numbers">
                                <!-- Les numéros de page seront générés dynamiquement -->
                            </div>
                            <button id="next-page"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Modals pour ajouter/modifier des éléments -->
        <div id="add-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modal-title">Ajouter un élément</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="add-edit-form">
                        <div class="form-group" id="name-group">
                            <label for="item-name">Nom</label>
                            <input type="text" id="item-name" required>
                        </div>
                        <div class="form-group" id="number-group" style="display: none;">
                            <label for="item-number">Numéro</label>
                            <input type="text" id="item-number">
                        </div>
                        <div class="form-group" id="status-group" style="display: none;">
                            <label for="item-status">Statut</label>
                            <select id="item-status">
                                <option value="pending">En attente</option>
                                <option value="verified">Vérifié</option>
                            </select>
                        </div>
                        <input type="hidden" id="item-id">
                        <input type="hidden" id="item-type">
                        <input type="hidden" id="parent-id">
                        <div class="form-actions">
                            <button type="button" id="cancel-button" class="btn btn-outline">Annuler</button>
                            <button type="submit" id="save-button" class="btn btn-primary">Enregistrer</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal de confirmation de suppression -->
        <div id="delete-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Confirmer la suppression</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <p>Êtes-vous sûr de vouloir supprimer cet élément ? Cette action est irréversible.</p>
                    <input type="hidden" id="delete-item-id">
                    <input type="hidden" id="delete-item-type">
                    <div class="form-actions">
                        <button type="button" id="cancel-delete" class="btn btn-outline">Annuler</button>
                        <button type="button" id="confirm-delete" class="btn btn-danger">Supprimer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal d'importation -->
        <div id="import-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Importer des données</h2>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="import-options">
                        <div class="form-group">
                            <label for="import-level">Niveau d'importation</label>
                            <select id="import-level">
                                <option value="field">Champs</option>
                                <option value="zone">Zones</option>
                                <option value="platform">Plateformes</option>
                                <option value="pid">PIDs</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="import-file">Fichier Excel</label>
                            <div class="file-input-container">
                                <input type="file" id="import-file" accept=".xlsx, .xls">
                                <button type="button" id="browse-file" class="btn btn-outline">Parcourir</button>
                                <span id="selected-filename">Aucun fichier sélectionné</span>
                            </div>
                        </div>
                    </div>
                    <div class="import-preview" id="import-preview" style="display: none;">
                        <h3>Aperçu des données</h3>
                        <div class="table-container">
                            <table id="preview-table">
                                <thead>
                                    <!-- Les en-têtes seront générés dynamiquement -->
                                </thead>
                                <tbody>
                                    <!-- Les données seront générées dynamiquement -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancel-import" class="btn btn-outline">Annuler</button>
                        <button type="button" id="confirm-import" class="btn btn-primary" disabled>Importer</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <svg role="img" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="150" height="45" viewBox="0 0 192 58.294" class="logo-svg">
                    <g fill="#ffffff">
                        <path d="M192.001 48.539h-11.364l-4.464 9.755-4.672-9.748H160.53a.185.185 0 0 1-.036-.231c.5-.79.9-1.638 1.333-2.464.28-.532.588-1.052.858-1.59.063-.126.186-.235.074-.405-.052-.08.039-.193.09-.22.406-.22.528-.648.723-1.006.749-1.38 1.461-2.78 2.2-4.166.748-1.406 1.517-2.8 2.266-4.207s1.476-2.8 2.214-4.194c.247-.469.5-.937.748-1.4a1.121 1.121 0 0 0 .161-.486 817.913 817.913 0 0 0 2.6-4.861 10.222 10.222 0 0 0 1.291-2.433 8.944 8.944 0 0 0 1.035-1.79 10.241 10.241 0 0 1 .577 1.008c.437.733.829 1.493 1.24 2.239.225.408.463.826.669 1.253.247.511.557 1 .818 1.5.246.474.512.941.759 1.415s.536.927.775 1.394c.694 1.354 1.427 2.687 2.149 4.025q4.371 8.094 8.76 16.178c.053.1.114.192.171.289Z"></path>
                    </g>
                </svg>
                <p>PERENCO Cameroun</p>
            </div>
            <div class="footer-links">
                <div class="footer-section">
                    <h3>Navigation</h3>
                    <ul>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="plateformes.html">Plateformes</a></li>
                        <li><a href="dashboard.html">Tableau de bord</a></li>
                        <li><a href="pid-management.html">Gestion PIDs</a></li>
                        <li><a href="about.html">À propos</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Douala, Cameroun</li>
                        <li><i class="fas fa-phone"></i> +237 233 XX XX XX</li>
                        <li><i class="fas fa-envelope"></i> contact@perenco-cameroun.com</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 PERENCO Cameroun. Tous droits réservés.</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="js/init.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/pid-management.js"></script>
</body>
</html>
